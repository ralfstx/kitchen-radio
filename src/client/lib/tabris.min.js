/*!
 * tabris.js 2014-10-24
 *
 * Copyright (c) 2014 EclipseSource.
 * All rights reserved.
 */
util={extend:function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a},pick:function(a,b){var c={};for(var d in a)-1!==b.indexOf(d)&&(c[d]=a[d]);return c},omit:function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},clone:function(a){var b={};for(var c in a)b[c]=a[c];return b},rename:function(a,b){var c={};for(var d in a)c[b[d]||d]=a[d];return c},invert:function(a){var b={};for(var c in a)b[a[c]]=c;return b},bind:function(a,b){return function(){return a.apply(b,arguments)}},extendPrototype:function(a,b){var c=function(){};return c.prototype=a.prototype,util.extend(new c,b,{"super":function(b){return a.prototype[b].apply(this,Array.prototype.slice.call(arguments,1))},Super:function(){a.apply(this,arguments)}})}},function(){util.colorArrayToString=function(a){var b=a[0],c=a[1],d=a[2],e=3===a.length?1:Math.round(100*a[3]/255)/100;return"rgba("+b+", "+c+", "+d+", "+e+")"},util.colorStringToArray=function(b){if(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/.test(b))return[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16),255];if(/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/.test(b))return[17*parseInt(RegExp.$1,16),17*parseInt(RegExp.$2,16),17*parseInt(RegExp.$3,16),255];if(/^rgb\s*\(\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*\)$/.test(b))return[Math.max(0,Math.min(255,parseInt(RegExp.$1))),Math.max(0,Math.min(255,parseInt(RegExp.$2))),Math.max(0,Math.min(255,parseInt(RegExp.$3))),255];if(/^rgba\s*\(\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?[0-9]+)\s*,\s*([+\-]?([0-9]*\.)?[0-9]+)\s*\)$/.test(b))return[Math.max(0,Math.min(255,parseInt(RegExp.$1))),Math.max(0,Math.min(255,parseInt(RegExp.$2))),Math.max(0,Math.min(255,parseInt(RegExp.$3))),Math.round(255*Math.max(0,Math.min(1,parseFloat(RegExp.$4))))];if(b in a){var c=a[b];return[c[0],c[1],c[2],255]}throw new Error("invalid color: "+b)};var a={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]}}(),function(){util.fontStringToArray=function(d){var e=[[],0,!1,!1],f=d.split(/(?:\s|^)\d+px(?:\s|$)/);return c(2===f.length||1===f.length,"Invalid font syntax"),e[1]=parseInt(/(?:\s|^)(\d+)px(?:\s|$)/.exec(d)[1],10),a(e,f[0]),b(e,f[1]),e},util.fontArrayToString=function(a){return(a[3]?"italic ":"")+(a[2]?"bold ":"")+(a[1]+"px")+(a[0][0]?" ":"")+a[0].join(", ")};var a=function(a,b){var d=b.trim().split(/\s+/);c(d.length<=2,"Too many font styles"),d.forEach(function(b){switch(b.trim()){case"italic":c(a[3]===!1,"Invalid font variant"),a[3]=!0;break;case"bold":c(a[2]===!1,"Invalid font weight"),a[2]=!0;break;case"normal":case"":break;default:throw new Error("Unknown font property: "+b.trim())}})},b=function(a,b){(b?b.split(","):[]).forEach(function(b){var d=/(?:^\s*[^\"\']+\s*$)|(?:^\s*\"[^\"\']+\"\s*$)|(?:^\s*\'[^\"\']+\'\s*$)/.exec(b);c(d,"Invalid font family: "+b),a[0].push(/^\s*[\"\']?([^\"\']*)/.exec(b)[1].trim())})},c=function(a,b){if(!a)throw new Error(b)}}(),function(){function a(a){return null!=a?a:null}util.imageToArray=function(b){return[b.src,a(b.width),a(b.height),a(b.scale)]},util.imageFromArray=function(a){var b={src:a[0]};return a.length>1&&(b.width=a[1]),a.length>2&&(b.height=a[2]),a.length>3&&(b.scale=a[3]),b}}(),function(){function a(){return{FocusIn:"focusin",FocusOut:"focusout",Selection:"selection",Resize:"resize",Scroll:"scroll",Modify:"modify"}}tabris=util.extend(function(a){return a in tabris._proxies?tabris._proxies[a]:new tabris.Proxy(a)},{_loadFunctions:[],_proxies:{},_localEventNames:a(),_nativeEventNames:util.invert(a()),load:function(a){tabris._loadFunctions.push(a)},create:function(a,b){if(!tabris._nativeBridge)throw new Error("tabris.js not started");return a in tabris||tabris.registerType(a,{}),(new tabris[a])._create(b)},registerType:function(a,b){if(a in tabris)throw new Error("Type already registered: "+a);tabris[a]=function(){tabris.Proxy.apply(this,arguments)},b.type=a,tabris[a].prototype=util.extendPrototype(tabris.Proxy,b)},_start:function(a){tabris._nativeBridge=a;for(var b=0;b<tabris._loadFunctions.length;)tabris._loadFunctions[b++].call();tabris.trigger("flush")},_notify:function(a,b,c){var d=tabris._proxies[a];d&&d._trigger(tabris._decodeEventName(b),tabris._decodeEventParam(b,c)),tabris.trigger("flush")},_reset:function(){this._loadFunctions=[],this._proxies={}},_decodeEventName:function(a){return this._localEventNames[a]||a},_encodeEventName:function(a){return this._nativeEventNames[a]||a},_decodeEventParam:function(a,b){return b}})}(),tabris.Events={on:function(a,b,c){this._callbacks||(this._callbacks=[]);var d=this._callbacks[a]||(this._callbacks[a]=[]);return d.push({fn:b,ctx:c}),this},off:function(a,b,c){if(this._callbacks)if(a){if(a in this._callbacks)if(b){for(var d=this._callbacks[a],e=d.length-1;e>=0;e--)d[e].fn!==b||c&&d[e].ctx!==c||d.splice(e,1);0===d.length&&(delete this._callbacks[a],0===Object.keys(this._callbacks).length&&delete this._callbacks)}else delete this._callbacks[a]}else delete this._callbacks;return this},trigger:function(a){if(this._callbacks&&a in this._callbacks)for(var b=this._callbacks[a],c=Array.prototype.slice.call(arguments,1),d=0;d<b.length;d++){var e=b[d];e.fn.apply(e.ctx||this,c)}return this},_isListening:function(a){return!!this._callbacks&&(!a||a in this._callbacks)}},util.extend(tabris,tabris.Events),tabris.Animation={validOptions:{delay:!0,duration:!0,repeat:!0,reverse:!0,easing:!0},animate:function(a,b,c){var d={};for(var e in c)this.validOptions[e]?d[e]=c[e]:console.warn('Invalid animation option "'+e+'"');tabris.create("tabris.Animation",util.extend(d,{target:a,properties:b})).on("Completion",function(){this.dispose()}).call("start")}},function(){var a=function(){};tabris.DOMEvent=function(a,b){this.type=a,this.timeStamp=Date.now(),"undefined"!=typeof b&&("bubbles"in b&&(this.bubbles=b.bubbles),"cancelable"in b&&(this.cancelable=b.cancelable))},tabris.DOMEvent.prototype={NONE:0,CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3,target:null,currentTarget:null,eventPhase:0,bubbles:!1,cancelable:!1,defaultPrevented:!1,isTrusted:!1,stopPropagation:a,stopImmediatePropagation:a,preventDefault:a},tabris._addDOMEventTargetMethods=function(a){if("function"!=typeof a.addEventListener){var b;a.addEventListener=function(a,c){b||(b=[]),a in b||(b[a]=[]);var d=b[a].indexOf(c);return-1===d&&b[a].push(c),1===b[a].length},a.removeEventListener=function(a,c){if(b&&a in b){var d=b[a].indexOf(c);if(-1!==d)return b[a].splice(d,1),0===b[a].length}return!1},a.dispatchEvent=function(a){if(b&&a.type in b)for(var c=b[a.type],d=0;d<c.length;d++)c[d].call(this,a)}}},"undefined"!=typeof window&&(tabris._addDOMEventTargetMethods(window),window.Event||(window.Event=tabris.DOMEvent))}(),function(){tabris._addWindowTimerMethods=function(a){function b(a,b,e){var f=c++,g=tabris.create("tabris.Timer",{delay:b,repeat:e}).on("Run",function(){a.call(),e||(g.dispose(),delete d[f])});return g.call("start"),d[f]=g,f}if("function"!=typeof a.setTimeout){var c=0,d={};a.setTimeout=function(a,c){return b(a,c,!1)},a.setInterval=function(a,c){return b(a,c,!0)},a.clearTimeout=a.clearInterval=function(a){var b=d[a];b&&(b.call("cancel",{}),b.dispose(),delete d[a])}}},"undefined"!=typeof window&&tabris._addWindowTimerMethods(window)}(),function(){tabris._addDeviceMethods=function(a){"devicePixelRatio"in a||Object.defineProperty(a,"devicePixelRatio",{get:function(){return tabris("tabris.Device").get("scaleFactor")},set:function(){}})},"undefined"!=typeof window&&tabris._addDeviceMethods(window)}(),function(){function a(a){return util.colorStringToArray(a)}function b(a){return util.fontStringToArray(a)}function c(a){return util.fontArrayToString(a)}function d(a){return util.imageToArray(a)}function e(a){return util.imageFromArray(a)}function f(a){return{left:a[0],top:a[1],width:a[2],height:a[3]}}function g(a){return a.map(function(a){return null==a?null:util.imageToArray(a)})}function h(a){return a.map(function(a){return null==a?null:util.imageFromArray(a)})}function i(a){if("centerX"in a){if("left"in a||"right"in a)return console.warn("Inconsistent layoutData: centerX overrides left and right"),util.omit(a,["left","right"])}else"left"in a||"right"in a||console.warn("Incomplete layoutData: either left, right or centerX should be specified");if("baseline"in a){if("top"in a||"bottom"in a||"centerY"in a)return console.warn("Inconsistent layoutData: baseline overrides top, bottom, and centerY"),util.omit(a,["top","bottom","centerY"])}else if("centerY"in a){if("top"in a||"bottom"in a)return console.warn("Inconsistent layoutData: centerY overrides top and bottom"),util.omit(a,["top","bottom"])}else"top"in a||"bottom"in a||console.warn("Incomplete layoutData: either top, bottom, centerY, or baseline should be specified");return a}function j(a){var b={};for(var c in a)b[c]=Array.isArray(a[c])?a[c].map(l):l(a[c]);return b}function k(a){return[a.left,a.top,a.width,a.height]}function l(a){return a instanceof tabris.Proxy?a.id:a}function m(a){return util.colorArrayToString(a)}function n(){return"o"+o++}tabris.Proxy=function(a){this.id=a||n(),tabris._proxies[this.id]=this},util.extend(tabris.Proxy.prototype,tabris.Events,{_create:function(a){var b=this._type||this.type,a=util.extend(this._properties||{},this._encodeProperties(a));return tabris._nativeBridge.create(this.id,b,a),this},append:function(){this._checkDisposed();for(var a=0;a<arguments.length;a++){if(!(arguments[a]instanceof tabris.Proxy))throw new Error("Cannot append non-widget");this._append(arguments[a])}return this},appendTo:function(a){if(this._checkDisposed(),!(a instanceof tabris.Proxy))throw new Error("Cannot append to non-widget");return a._append(this),this},_append:function(a){a.set("parent",this)},get:function(a){return this._checkDisposed(),this._decodeProperty(a,tabris._nativeBridge.get(this.id,a))},set:function(a,b){this._checkDisposed();var c;return"string"==typeof a?(c={},c[a]=b):c=a,tabris._nativeBridge.set(this.id,this._encodeProperties(c)),this},animate:function(a,b){tabris.Animation.animate(this,a,b)},call:function(a,b){return this._checkDisposed(),tabris._nativeBridge.call(this.id,a,b)},on:function(a,b,c){this._checkDisposed();var d=this._isListening(a);return tabris.Events.on.call(this,a,b,c),d||tabris._nativeBridge.listen(this.id,tabris._encodeEventName(a),!0),this},off:function(a,b,c){return this._checkDisposed(),tabris.Events.off.call(this,a,b,c),this._isListening(a)||tabris._nativeBridge.listen(this.id,tabris._encodeEventName(a),!1),this},dispose:function(){this._isDisposed||(tabris._nativeBridge.destroy(this.id),this._destroy(),this._parent&&this._parent._removeChild(this),this._isDisposed=!0)},_trigger:function(){this.trigger.apply(this,arguments)},_destroy:function(){this._destroyChildren(),this.trigger("dispose",{}),tabris.Events.off.call(this),delete tabris._proxies[this.id]},_destroyChildren:function(){if(this._children)for(var a=0;a<this._children.length;a++)this._children[a]._destroy()},_addChild:function(a){this._children||(this._children=[]),this._children.push(a)},_removeChild:function(a){if(this._children){var b=this._children.indexOf(a);-1!==b&&this._children.splice(b,1)}},_checkDisposed:function(){if(this._isDisposed)throw new Error("Object is disposed")},_encodeProperties:function(a){var b={};for(var c in a)this._setProperty(c,a[c],b);return b},_setProperty:function(a,b,c){try{c[a]=this._encodeProperty(a,b)}catch(d){console.warn("Unsupported "+a+" value: "+d.message)}},_encodeProperty:function(c,e){switch(c){case"foreground":case"background":return a(e);case"font":return b(e);case"image":case"backgroundImage":return d(e);case"images":return g(e);case"layoutData":return j(i(e));case"bounds":return k(e);case"parent":return this._setParent(e),l(e._getContainer())}return l(e)},_getContainer:function(){return this},_setParent:function(a){this._parent&&this._parent._removeChild(this),this._parent=a,this._parent._addChild(this)},_decodeProperty:function(a,b){switch(a){case"foreground":case"background":return m(b);case"font":return c(b);case"image":case"backgroundImage":return e(b);case"bounds":return f(b);case"images":return h(b)}return b}});var o=1,p={password:["BORDER","SINGLE","PASSWORD"],search:["BORDER","SINGLE","SEARCH"],multiline:["BORDER","MULTI"],"default":["BORDER","SINGLE"]};tabris.registerType("Button",{_type:"rwt.widgets.Button",_properties:{style:["PUSH"]}}),tabris.registerType("Canvas",{_type:"rwt.widgets.Canvas"}),tabris.registerType("CheckBox",{_type:"rwt.widgets.Button",_properties:{style:["CHECK"]}}),tabris.registerType("Combo",{_type:"rwt.widgets.Combo"}),tabris.registerType("Composite",{_type:"rwt.widgets.Composite"}),tabris.registerType("ImageView",{_type:"tabris.ImageView"}),tabris.registerType("ProgressBar",{_type:"rwt.widgets.ProgressBar"}),tabris.registerType("RadioButton",{_type:"rwt.widgets.Button",_properties:{style:["RADIO"]}}),tabris.registerType("Slider",{_type:"rwt.widgets.Scale"}),tabris.registerType("ToggleButton",{_type:"rwt.widgets.Button",_properties:{style:["TOGGLE"]}}),tabris.registerType("Label",{_type:"rwt.widgets.Label"}),tabris.registerType("Text",{_type:"rwt.widgets.Text",_create:function(a){var b=p[a.type]||p["default"];return this.super("_create",util.extend({style:b},a))}}),tabris.registerType("WebView",{_type:"rwt.widgets.Browser"})}(),tabris.UIProxy=function(){this._pages=[]},tabris.UIProxy.prototype={_create:function(){var a=this;return tabris.create("rwt.widgets.Display"),tabris._shell=tabris.create("rwt.widgets.Shell",{style:["NO_TRIM"],mode:"maximized",active:!0,visibility:!0}),tabris._shell.on("Close",function(){tabris._shell.dispose()}),this._ui=tabris.create("tabris.UI",{shell:tabris._shell}),this._ui.on("ShowPage",function(b){var c=tabris._proxies[b.pageId];a.setActivePage(c)}),this._ui.on("ShowPreviousPage",function(){a.getActivePage().close()}),this},_install:function(a){a._uiProxy=this},setActivePage:function(a){this._pages.push(a),this._ui.set("activePage",a)},getActivePage:function(){return this._pages[this._pages.length-1]},setLastActivePage:function(){this._pages.pop();var a=this.getActivePage();a&&this._ui.set("activePage",a)}},tabris.load(function(){(new tabris.UIProxy)._create()._install(tabris)}),function(){function a(a,b,c){return function(d){for(var e=[],f=0;b>f;f++){var g=a[f];e.push(g in d?d[g]:c)}return e}}tabris.registerType("List",{_type:"rwt.widgets.Grid",_create:function(a){return this.super("_create",util.extend({style:["V_SCROLL"]},a)),tabris.create("rwt.widgets.ScrollBar",{parent:this,style:["VERTICAL"]}),this._createItems(),this},get:function(a){return"items"===a?(this._checkDisposed(),this._items||[]):"template"===a?(this._checkDisposed(),this._template||[]):this.super("get",a)},set:function(a,b){this.super("set",a,b),this._createItems()},_trigger:function(a){if("selection"===a){var b=arguments[1],c=this._findItemIndex(b.item),d=this._items?this._items[c]:null,e=b.text?b.text:"";return this.trigger(a,{item:d,index:c,cell:e})}tabris.Proxy.prototype._trigger.apply(this,arguments)},_findItemIndex:function(a){for(var b=0;b<this._children.length;b++)if(this._children[b].id===a)return b-1;return-1},_setProperty:function(a,b,c){switch(a){case"template":this._checkDisposed(),this._setTemplate(b,c);break;case"items":this._checkDisposed(),this._setItems(b,c);break;default:this.super("_setProperty",a,b,c)}},_setTemplate:function(a,b){if(this._template=a,this._template){this._bindings={text:[],image:[]};for(var c=[],d=0;d<this._template.length;d++){var e=this._template[d],f=util.omit(e,["binding","foreground","background"]);if("binding"in e&&e.type in this._bindings){var g=this._bindings[e.type];f.bindingIndex=g.length,g.push(e.binding)}"foreground"in e&&(f.foreground=util.colorStringToArray(e.foreground)),"background"in e&&(f.background=util.colorStringToArray(e.background)),c.push(f)}this._bindings.length=Math.max(this._bindings.text.length,this._bindings.image.length),b.rowTemplate=c}else delete this._bindings},_setItems:function(a,b){this._items=a,b.itemCount=a?a.length:0,this._itemsPending=!0},_createItems:function(){if(this._itemsPending){if(this._disposeItems(),this._items)for(var a=this._createTextsFn(),b=this._createImagesFn(),c=0;c<this._items.length;c++){var d=this._items[c];tabris.create("rwt.widgets.GridItem",{parent:this,index:c,texts:a(d),images:b(d)})}delete this._itemsPending}},_disposeItems:function(){if(this._children)for(var a=this._children.length-1;a>0;a--)this._children[a].dispose()},_createTextsFn:function(){return this._bindings?a(this._bindings.text,this._bindings.length,""):function(a){return[a.toString()]}},_createImagesFn:function(){return this._bindings?a(this._bindings.image,this._bindings.length,null):function(){return[null]}}})}(),function(){tabris.registerType("ScrollComposite",{_type:"rwt.widgets.ScrolledComposite",_create:function(a){var b=util.omit(a,["scroll"]);return this.super("_create",util.extend(b,{style:"horizontal"===a.scroll?["H_SCROLL"]:["V_SCROLL"]})),this._scrollBar=new tabris.Proxy,tabris._nativeBridge.create(this._scrollBar.id,"rwt.widgets.ScrollBar",{parent:this.id,style:"horizontal"===a.scroll?["HORIZONTAL"]:["VERTICAL"]}),this._composite=new tabris.Proxy,tabris._nativeBridge.create(this._composite.id,"rwt.widgets.Composite",{parent:this.id}),this.set("content",this._composite),this},on:function(a,b,c){return"scroll"!==a||this._isListening("scroll")||this._scrollBar.on("selection",this._scrollBarListener,this),this.super("on",a,b,c)},off:function(a,b,c){var d=this.super("off",a,b,c);return"scroll"!==a||this._isListening("scroll")||this._scrollBar.off("selection",this._scrollBarListener,this),d},_scrollBarListener:function(){var a=this.get("origin");this.trigger("scroll",{x:a[0],y:a[1]})},_getContainer:function(){return this._composite}})}(),tabris.registerType("Page",{_type:"tabris.Page",_PAGE_PROPS:["title","image","style","topLevel"],_create:function(a){var b=util.extend(util.omit(a,this._PAGE_PROPS),{parent:tabris._shell,layoutData:{left:0,right:0,top:0,bottom:0}});this._composite=tabris.create("rwt.widgets.Composite",b);var c=util.extend(util.pick(a,this._PAGE_PROPS),{parent:tabris._uiProxy._ui,control:this._composite});return this.super("_create",c),this},get:function(a){return-1!==this._PAGE_PROPS.indexOf(a)?this.super("get",a):this._composite.get(a)},set:function(a,b){var c;return"string"==typeof a?(c={},c[a]=b):c=a,this.super("set",util.pick(c,this._PAGE_PROPS)),this._composite.set(util.omit(c,this._PAGE_PROPS)),this},call:function(a,b){return this._composite.call(a,b),this},on:function(a,b){return this._composite.on(a,b),this},off:function(a,b){return this._composite.off(a,b),this},dispose:function(){this._composite.dispose(),this.super("dispose")},open:function(){tabris._uiProxy.setActivePage(this)},close:function(){this._composite.dispose(),tabris._uiProxy.setLastActivePage(),this.dispose()},_getContainer:function(){return this._composite}}),tabris.registerType("Action",{_type:"tabris.Action",_create:function(a){return this.super("_create",util.extend({parent:tabris._uiProxy._ui},a))}}),function(){function a(a){return util.omit(a||{},h)}function b(a){return util.rename(util.pick(a||{},g),i)}function c(a){var b=a||{};return b.paging&&(b=util.omit(b,["paging"]),b.data={paging:a.paging}),b}function d(a){return a instanceof f}function e(a){var b;return"string"==typeof a[0]?(b={},b[a[0]]=a[1]):b=a[0],b}tabris.registerType("TabFolder",{_type:"rwt.widgets.TabFolder",_create:function(a){return this.super("_create",c(a))},_getItems:function(){return this._children.filter(d)},set:function(){var a=e(arguments);return"paging"in a&&(this._paging=a.paging),this.super("set",c(a))},get:function(a){return"paging"===a?!!this._paging:this.super("get",a)}}),tabris.registerType("Tab",{_type:"rwt.widgets.Composite",_create:function(c){return this.super("_create",a(c)),this._tabItem=new f,this._tabItem.set(util.extend(b(c),{control:this.id})),this.on("dispose",this._tabItem.dispose,this._tabItem),this},set:function(){var c=e(arguments);return this.super("set",a(c)),this._tabItem.set(b(c)),this},get:function(a){return-1!==h.indexOf(a)?this._tabItem.get(i[a]||a):this.super("get",a)}});var f=function(){tabris.Proxy.apply(this,arguments)};f.prototype=util.extendPrototype(tabris.Proxy,{type:"rwt.widgets.TabItem",set:function(){this._checkDisposed();var a=e(arguments);if(this._parent||a.parent)if(!this._parent&&a.parent){if(!(a.parent instanceof tabris.TabFolder))throw new Error("Tab must be a child of TabFolder");a=util.extend(this._propertyCache||{},a),delete this._propertyCache,a.index=a.parent._getItems().length,this._create(a)}else this.super("set",a);else this._propertyCache=util.extend(this._propertyCache||{},a);return this},get:function(a){return this._parent?this.super("get",a):this._propertyCache[a]}});var g=["title","image","badge","parent"],h=["title","image","badge"],i={title:"text"}}(),function(){function a(a){return a}function b(a){if(a in this.values)return a;throw new Error(a)}function c(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function d(){var a={};for(var b in f)a[b]=f[b].init;return a}function e(a,b){var c=f[b];Object.defineProperty(a,b,{get:function(){return c.decode(a._state[b])},set:function(d){try{a._state[b]=c.encode(d),c.addOperations(a,a._state[b])}catch(e){console.warn("Unsupported value for "+b+": "+d)}}})}tabris.CanvasContext=function(a){this._gc=a,this._state=d(),this._savedStates=[],this._opCodes=[],this._newOpCodes=[],this._operations=[],this._ints=[],this._doubles=[],this._booleans=[],this._strings=[],this.canvas={width:0,height:0,style:{}};for(var b in f)e(this,b);tabris.on("flush",this._flush,this),a.on("dispose",function(){tabris.off("flush",this._flush,this)},this)},tabris.CanvasContext.prototype={save:function(){this._pushOperation("save"),this._savedStates.push(util.clone(this._state))},restore:function(){this._pushOperation("restore"),this._state=this._savedStates.pop()||this._state},beginPath:function(){this._pushOperation("beginPath")},closePath:function(){this._pushOperation("closePath")},lineTo:function(a,b){this._pushOperation("lineTo"),this._doubles.push(a,b)},moveTo:function(a,b){this._pushOperation("moveTo"),this._doubles.push(a,b)},bezierCurveTo:function(a,b,c,d,e,f){this._pushOperation("bezierCurveTo"),this._doubles.push(a,b,c,d,e,f)},quadraticCurveTo:function(a,b,c,d){this._pushOperation("quadraticCurveTo"),this._doubles.push(a,b,c,d)},rect:function(a,b,c,d){this._pushOperation("rect"),this._doubles.push(a,b,c,d)},arc:function(a,b,c,d,e,f){this._pushOperation("arc"),this._doubles.push(a,b,c,d,e),this._booleans.push(!!f)},scale:function(a,b){this._pushOperation("scale"),this._doubles.push(a,b)},rotate:function(a){this._pushOperation("rotate"),this._doubles.push(a)},translate:function(a,b){this._pushOperation("translate"),this._doubles.push(a,b)},transform:function(a,b,c,d,e,f){this._pushOperation("transform"),this._doubles.push(a,b,c,d,e,f)},setTransform:function(a,b,c,d,e,f){this._pushOperation("setTransform"),this._doubles.push(a,b,c,d,e,f)},clearRect:function(a,b,c,d){this._pushOperation("clearRect"),this._doubles.push(a,b,c,d)},fillRect:function(a,b,c,d){this._pushOperation("beginPath"),this._pushOperation("rect"),this._doubles.push(a,b,c,d),this.fill()},strokeRect:function(a,b,c,d){this._pushOperation("beginPath"),this._pushOperation("rect"),this._doubles.push(a,b,c,d),this.stroke()},fillText:function(a,b,c){this._pushOperation("fillText"),this._strings.push(a),this._booleans.push(!1,!1,!1),this._doubles.push(b,c)},strokeText:function(a,b,c){this._pushOperation("strokeText"),this._strings.push(a),this._booleans.push(!1,!1,!1),this._doubles.push(b,c)},fill:function(){this._pushOperation("fill")},stroke:function(){this._pushOperation("stroke")},measureText:function(a){return{width:5*a.length+5}},_init:function(a,b){this.canvas.width=a,this.canvas.height=b,this._gc.call("init",{width:a,height:b,font:[["sans-serif"],12,!1,!1],fillStyle:[0,0,0,255],strokeStyle:[0,0,0,255]})},_flush:function(){this._operations.length>0&&(this._gc.call("draw",{packedOperations:[this._newOpCodes,this._operations,this._doubles,this._booleans,this._strings,this._ints]}),this._operations=[],this._doubles=[],this._booleans=[],this._strings=[],this._ints=[],this._newOpCodes=[])},_pushOperation:function(a){this._opCodes.indexOf(a)<0&&(this._newOpCodes.push(a),this._opCodes.push(a)),this._operations.push(this._opCodes.indexOf(a))}},tabris.getContext=function(a,b,c){return a._gc||(a._gc=tabris.create("rwt.widgets.GC",{parent:a})),a._ctx||(a._ctx=tabris._nativeBridge.V8?new tabris.CanvasContext(a._gc):new tabris.LegacyCanvasContext(a._gc)),a._ctx._init(b,c),a._ctx};var f={lineWidth:{init:1,encode:function(a){if(a>0)return a;throw new Error(a)},decode:a,addOperations:function(a,b){a._pushOperation("lineWidth"),a._doubles.push(b)}},lineCap:{init:"butt",values:c(["butt","round","square"]),encode:b,decode:a,addOperations:function(a,b){a._pushOperation("lineCap"),a._strings.push(b)}},lineJoin:{init:"miter",values:c(["bevel","miter","round"]),encode:b,decode:a,addOperations:function(a,b){a._pushOperation("lineJoin"),a._strings.push(b)}},fillStyle:{init:[0,0,0,255],encode:util.colorStringToArray,decode:util.colorArrayToString,addOperations:function(a,b){a._pushOperation("fillStyle"),a._ints.push(b[0],b[1],b[2],b[3])}},strokeStyle:{init:[0,0,0,255],encode:util.colorStringToArray,decode:util.colorArrayToString,addOperations:function(a,b){a._pushOperation("strokeStyle"),a._ints.push(b[0],b[1],b[2],b[3])}},textAlign:{init:"start",values:c(["start","end","left","right","center"]),encode:b,decode:a,addOperations:function(a,b){a._pushOperation("textAlign"),a._strings.push(b)}},textBaseline:{init:"alphabetic",values:c(["top","hanging","middle","alphabetic","ideographic","bottom"]),encode:b,decode:a,addOperations:function(a,b){a._pushOperation("textBaseline"),a._strings.push(b)}}}}(),function(){function a(a){return a}function b(a){if(a in this.values)return a;throw new Error(a)}function c(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function d(){var a={};for(var b in f)a[b]=f[b].init;return a}function e(a,b){var c=f[b];Object.defineProperty(a,b,{get:function(){return c.decode(a._state[b])},set:function(d){try{a._state[b]=c.encode(d),a._operations.push([b,this._state[b]])}catch(e){console.warn("Unsupported value for "+b+": "+d)}}})}tabris.LegacyCanvasContext=function(a){this._gc=a,this._state=d(),this._savedStates=[],this._operations=[],this.canvas={width:0,height:0,style:{}};for(var b in f)e(this,b);tabris.on("flush",this._flush,this),a.on("dispose",function(){tabris.off("flush",this._flush,this)},this)},tabris.LegacyCanvasContext.prototype={save:function(){this._operations.push(["save"]),this._savedStates.push(util.clone(this._state))},restore:function(){this._operations.push(["restore"]),this._state=this._savedStates.pop()||this._state},beginPath:function(){this._operations.push(["beginPath"])},closePath:function(){this._operations.push(["closePath"])},lineTo:function(a,b){this._operations.push(["lineTo",a,b])},moveTo:function(a,b){this._operations.push(["moveTo",a,b])},bezierCurveTo:function(a,b,c,d,e,f){this._operations.push(["bezierCurveTo",a,b,c,d,e,f])},quadraticCurveTo:function(a,b,c,d){this._operations.push(["quadraticCurveTo",a,b,c,d])},rect:function(a,b,c,d){this._operations.push(["rect",a,b,c,d])},arc:function(a,b,c,d,e,f){this._operations.push(["arc",a,b,c,d,e,!!f])},scale:function(a,b){this._operations.push(["scale",a,b])},rotate:function(a){this._operations.push(["rotate",a])},translate:function(a,b){this._operations.push(["translate",a,b])},transform:function(a,b,c,d,e,f){this._operations.push(["transform",a,b,c,d,e,f])},setTransform:function(a,b,c,d,e,f){this._operations.push(["setTransform",a,b,c,d,e,f])},clearRect:function(a,b,c,d){this._operations.push(["clearRect",a,b,c,d])},fillRect:function(a,b,c,d){this._operations.push(["beginPath"],["rect",a,b,c,d]),this.fill()},strokeRect:function(a,b,c,d){this._operations.push(["beginPath"],["rect",a,b,c,d]),this.stroke()},fillText:function(a,b,c){this._operations.push(["fillText",a,!1,!1,!1,b,c])},strokeText:function(a,b,c){this._operations.push(["strokeText",a,!1,!1,!1,b,c])},fill:function(){this._operations.push(["fill"])},stroke:function(){this._operations.push(["stroke"])},measureText:function(a){return{width:5*a.length+5}},_init:function(a,b){this.canvas.width=a,this.canvas.height=b,this._gc.call("init",{width:a,height:b,font:[["sans-serif"],12,!1,!1],fillStyle:[0,0,0,255],strokeStyle:[0,0,0,255]})},_flush:function(){this._operations.length>0&&(this._gc.call("draw",{operations:this._operations}),this._operations=[])}};var f={lineWidth:{init:1,encode:function(a){if(a>0)return a;throw new Error(a)},decode:a},lineCap:{init:"butt",values:c(["butt","round","square"]),encode:b,decode:a},lineJoin:{init:"miter",values:c(["bevel","miter","round"]),encode:b,decode:a},fillStyle:{init:[0,0,0,255],encode:util.colorStringToArray,decode:util.colorArrayToString},strokeStyle:{init:[0,0,0,255],encode:util.colorStringToArray,decode:util.colorArrayToString},textAlign:{init:"start",values:c(["start","end","left","right","center"]),encode:b,decode:a},textBaseline:{init:"alphabetic",values:c(["top","hanging","middle","alphabetic","ideographic","bottom"]),encode:b,decode:a}}}(),function(){var a;tabris.WebStorage=function(){a=tabris("tabris.ClientStore")},tabris.WebStorage.prototype={setItem:function(b,c){if(!b)throw new TypeError("Key argument must be specified to execute 'setItem'");if(!c)throw new TypeError("Value argument must be specified to execute 'setItem'");"string"==typeof b&&"string"==typeof c&&a.call("add",{key:b,value:c})},getItem:function(b){return"string"==typeof b?a.call("get",{key:b}):void 0},removeItem:function(b){"string"==typeof b&&a.call("remove",{keys:[b]})},clear:function(){a.call("clear")}},tabris.StorageEvent=function(a){this.type=a},tabris.StorageEvent.prototype=util.extendPrototype(tabris.DOMEvent,{bubbles:!1,cancelable:!1,key:"",oldValue:null,newValue:null,url:"",storageArea:null}),window.Storage||(window.Storage=tabris.WebStorage,window.localStorage=new tabris.WebStorage)}(),function(){var a=["loadstart","readystatechange","load","loadend","progress","timeout","abort","error"],b=["progress","loadstart","load","loadend","timeout","abort","error"];tabris.XMLHttpRequest=function(){var a=c(this);e(this,a),f(this,a),g(this,a),i(this,a),h(this,a),j(this,a),m(this,a),n(this,a),o(this,a),k(this,a),d(a),this.open=p(this,a),this.send=q(this,a),this.abort=r(this,a),this.setRequestHeader=s(this,a),this.getResponseHeader=t(this,a),this.getAllResponseHeaders=u(this,a),tabris._addDOMEventTargetMethods(this),tabris._addDOMEventTargetMethods(a.uploadEventTarget)},tabris.XMLHttpRequest.prototype={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},tabris.XMLHttpRequestProgressEvent=function(a){this.type=a},tabris.XMLHttpRequestProgressEvent.prototype=util.extendPrototype(tabris.DOMEvent,{lengthComputable:!1,loaded:0,total:0});var c=function(a){var b={};return b.proxy=null,b.authorRequestHeaders={},b.uploadListeners={},b.uploadEventTarget={},b.timeout=0,b.status=0,b.statusText="",b.responseHeaders="",b.readyState=a.UNSENT,b.responseText="",b.withCredentials=!1,b.responseType="",b.sendInvoked=!1,b.isSynchronous=!1,b.error=!1,b.uploadComplete=!1,b},d=function(c){a.forEach(function(a){c["on"+a]=null}),b.forEach(function(a){c.uploadListeners["on"+a]=null})},e=function(a,b){Object.defineProperty(a,"upload",{get:function(){return b.uploadEventTarget},set:function(){}})},f=function(a,b){Object.defineProperty(a,"readyState",{get:function(){return b.readyState},set:function(){}})},g=function(a,b){Object.defineProperty(a,"timeout",{get:function(){return b.timeout},set:function(a){isNaN(a)||(b.timeout=Math.round(a))}})},h=function(a,b){Object.defineProperty(a,"responseText",{get:function(){if(null===b.responseText)return"";
if("string"!=typeof b.responseText)throw new Error("IllegalStateError: responseText is not a string");return b.readyState!==a.LOADING&&b.readyState!==a.DONE?"":b.error?"":b.responseText},set:function(){}})},i=function(a,b){Object.defineProperty(a,"response",{get:function(){return b.readyState!==a.LOADING&&b.readyState!==a.DONE?"":b.error?"":b.responseText},set:function(){}})},j=function(a,b){Object.defineProperty(a,"responseType",{get:function(){return b.responseType},set:function(c){if(b.readyState===a.LOADING||b.readyState===a.DONE)throw new Error("InvalidStateError: state must not be 'LOADING' or 'DONE' when setting responseType");if(!(["arraybuffer","blob","document","json","text"].indexOf(c)<0)){if(["arraybuffer","blob","document","json"].indexOf(c)>-1)throw new Error("Only the 'text' response type is supported.");b.responseType=c}}})},k=function(c,d){a.forEach(function(a){l(a,c,d)}),b.forEach(function(a){l(a,d.uploadEventTarget,d.uploadListeners)})},l=function(a,b,c){var d="on"+a;Object.defineProperty(b,d,{get:function(){return c[d]},set:function(e){"function"==typeof e&&(b.removeEventListener(a,b[d]),c[d]=e,b.addEventListener(a,b[d]))}})},m=function(a,b){Object.defineProperty(a,"status",{get:function(){return[a.OPENED,a.UNSENT].indexOf(b.readyState)>-1?0:b.error?0:b.status},set:function(){}})},n=function(a,b){Object.defineProperty(a,"statusText",{get:function(){return[a.OPENED,a.UNSENT].indexOf(b.readyState)>-1?"":b.error?"":b.statusText},set:function(){}})},o=function(a,b){Object.defineProperty(a,"withCredentials",{set:function(c){if(b.readyState!==a.UNSENT&&b.readyState!==a.OPENED)throw new Error("InvalidStateError: state must be 'UNSENT' or 'OPENED' when setting withCredentials");if(b.sendInvoked)throw new Error("InvalidStateError: 'send' invoked, failed to set 'withCredentials'");"boolean"==typeof c&&(b.withCredentials=c)},get:function(){return b.withCredentials}})},p=function(a,b){return function(c,d,e,f,g){var h={};y(c,d),h.source=d;var i=d.replace(/.*?:\/\//g,"");if(h.isRelative=!new RegExp("^(?:[a-z]+:)?//","i").test(d),h.userdata=i.substring(0,i.indexOf("@")),"undefined"==typeof e&&(e=!0,f=null,g=null),!e)throw new Error("Only asynchronous request supported.");h.isRelative&&f&&g&&(h.userdata=f+":"+g),b.requestMethod=c,b.requestUrl=h,b.isSynchronous=!e,b.authorRequestHeaders={},b.sendInvoked=!1,b.responseText=null,b.readyState!==a.OPENED&&(b.readyState=a.OPENED,J("readystatechange",a))}},q=function(a,b){return function(c){if(b.proxy=tabris.create("tabris.HttpRequest"),b.proxy.on("StateChange",function(c){w(c,a,b)}),b.proxy.on("DownloadProgress",function(b){E("progress",a,b.lengthComputable,b.loaded,b.total)}),b.proxy.on("UploadProgress",function(b){E("progress",a.upload,b.lengthComputable,b.loaded,b.total)}),b.readyState!==a.OPENED)throw new Error("InvalidStateError: Object's state must be 'OPENED', failed to execute 'send'");if(b.sendInvoked)throw new Error("InvalidStateError: 'send' invoked, failed to execute 'send'");["GET","HEAD"].indexOf(b.requestMethod)>-1&&(c=null),b.requestBody=c,b.error=b.uploadComplete=!1,c||(b.uploadComplete=!0),b.withCredentials&&b.requestUrl.userdata&&a.setRequestHeader("Authorization","Basic "+b.requestUrl.userdata),b.sendInvoked=!0,E("loadstart",a),b.uploadComplete||E("loadstart",a.upload),b.proxy.call("send",{url:b.requestUrl.source,method:b.requestMethod,timeout:a.timeout,headers:b.authorRequestHeaders,data:b.requestBody})}},r=function(a,b){return function(){b.proxy&&b.proxy.call("abort"),[a.UNSENT,a.OPENED].indexOf(b.readyState)>-1&&!b.sendInvoked||b.readyState===a.DONE||(J("readystatechange",a),b.uploadComplete||(b.uploadComplete=!0,F(a.upload)),F(a)),b.readyState=a.UNSENT}},s=function(a,b){return function(c,d){if(b.readyState!==a.OPENED)throw new Error("InvalidStateError: Object's state must be 'OPENED', failed to execute 'setRequestHeader'");if(b.sendInvoked)throw new Error("InvalidStateError: cannot set request header if 'send()' invoked and request not completed");if(!A(c))throw new TypeError("Invalid HTTP header name, failed to execute 'open'");if(!B(d))throw new TypeError("Invalid HTTP header value, failed to execute 'open'");if(C(c))throw new Error("Cannot set forbidden header '"+c+"'");b.authorRequestHeaders[c]=c in b.authorRequestHeaders?b.authorRequestHeaders[c]+", "+d:d}},t=function(a,b){return function(c){if([a.UNSENT,a.OPENED].indexOf(a.readyState)>-1)return null;if(b.error)return null;var d=["set-cookie","set-cookie2","status"];if(d.indexOf(c.toLowerCase())>-1)return null;for(var e in b.responseHeaders)if(e.toLowerCase()===c.toLowerCase())return b.responseHeaders[e];return null}},u=function(a,b){return function(){return[a.UNSENT,a.OPENED].indexOf(a.readyState)>-1?"":b.error?"":v(b.responseHeaders)}},v=function(a){var b=[],c=["set-cookie","set-cookie2","status"];for(var d in a)c.indexOf(d.toLowerCase())<0&&b.push(d+": "+a[d]);return b.join("\n")},w=function(a,b,c){switch(a.state){case"headers":c.readyState=b.HEADERS_RECEIVED,c.status=a.code,c.statusText=a.message,c.responseHeaders=a.headers,J("readystatechange",b),c.uploadComplete=!0,H(b.upload);break;case"loading":c.readyState=b.LOADING,J("readystatechange",b);break;case"finished":c.responseText=a.response,c.readyState=b.DONE,J("readystatechange",b),H(b),H(b.upload),c.proxy.dispose(),c.proxy=null;break;case"error":x("error",b,c);break;case"timeout":x("timeout",b,c);break;case"abort":x("abort",b,c)}},x=function(a,b,c){c.error=!0,c.readyState=b.DONE,J("readystatechange",b),G(a,b),c.uploadComplete||(c.uploadComplete=!0,G(a,b.upload))},y=function(a,b){if(!a)throw new TypeError("Method argument should be specified to execute 'open'");if(!b)throw new TypeError("URL argument should be specified to execute 'open'");z(a)},z=function(a){if(!A(a))throw new TypeError("Invalid HTTP method, failed to execute 'open'");var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"],c=a.toUpperCase();b.indexOf(c)>=0&&(a=c);var d=["CONNECT","TRACE","TRACK"];if(d.indexOf(a)>=0)throw new Error("SecurityError: '"+a+"' HTTP method is not secure, failed to execute 'open'")},A=function(a){var b=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"];return!(/[^\x21-\x7E]/.test(a)||b.indexOf(a)>=0)},B=function(a){return!(!/[*A-z\u00C0-\u00ff]+/g.test(a)||a.indexOf("\n")>-1||a.indexOf("\r")>-1)},C=function(a){return D.indexOf(a.toLowerCase())>-1},D=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],E=function(a,b,c,d,e){b.dispatchEvent(I(a,b,c,d,e))},F=function(a){E("progress",a),E("abort",a),E("loadend",a)},G=function(a,b){E("progress",b),E(a,b),E("loadend",b)},H=function(a){E("load",a),E("loadend",a)},I=function(a,b,c,d,e){var f=new tabris.XMLHttpRequestProgressEvent(a);return f.currentTarget=f.target=b,c&&(f.lengthComputable=c),d&&(f.loaded=d),e&&(f.total=e),f},J=function(a,b){var c=K(a,b);b.dispatchEvent(c)},K=function(a,b){var c=new tabris.DOMEvent(a);return c.currentTarget=c.target=b,c};"undefined"==typeof XMLHttpRequest&&(window.XMLHttpRequest=tabris.XMLHttpRequest,window.XMLHttpRequestProgressEvent=tabris.XMLHttpRequestProgressEvent)}();